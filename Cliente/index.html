<!DOCTYPE html>
<html>
<head>
    <title>Controle de Slide</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { 
            font-family: sans-serif; 
            background: #222; 
            color: white;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* --- TELA DE CONFIGURAÇÃO (IP) --- */
        #tela-config {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
            padding: 20px;
        }

        input {
            padding: 15px;
            font-size: 1.2rem;
            border-radius: 5px;
            border: none;
            width: 100%;
            max-width: 300px;
            margin-bottom: 20px;
            text-align: center;
        }

        .btn-entrar {
            padding: 15px 30px;
            font-size: 1.2rem;
            background-color: #2196F3; /* Azul */
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            max-width: 300px;
        }

        /* --- TELA DE CONTROLE (BOTÕES) --- */
        #tela-controle {
            display: none; /* Começa escondido */
            flex: 1;
            flex-direction: row; /* Botões lado a lado */
        }

        .btn-slide { 
            flex: 1; 
            font-size: 2rem; 
            border: none; 
            color: white; 
            cursor: pointer; 
            margin: 5px; 
            border-radius: 10px;
            transition: opacity 0.2s;
        }
        
        .btn-slide:active { opacity: 0.7; }
        .prev { background-color: #f44336; } /* Vermelho */
        .next { background-color: #4CAF50; } /* Verde */

        /* Botãozinho para voltar e trocar o IP */
        .btn-voltar {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.5);
            color: #ddd;
            border: 1px solid #555;
            padding: 5px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8rem;
        }
    </style>
</head>
<body>

    <div id="tela-config">
        <h2>Conectar ao PC</h2>
        <p style="color: #aaa; margin-bottom: 10px;">Digite o IPv4 do computador:</p>
        <input type="text" id="inputIP" placeholder="Ex: 192.168.0.15">
        <button class="btn-entrar" onclick="salvarIpEConectar()">CONECTAR</button>
    </div>

    <div id="tela-controle">
        <button class="btn-voltar" onclick="trocarIP()">Trocar IP</button>
        <button class="btn-slide prev" onclick="enviarComando('E')">ANTERIOR</button>
        <button class="btn-slide next" onclick="enviarComando('D')">PRÓXIMO</button>
    </div>

    <script>
        // Variável global para guardar o endereço
        let urlBase = "";
        const PORTA = "8080";

        // Tenta carregar o último IP usado para facilitar
        window.onload = function() {
            const ipSalvo = localStorage.getItem("ultimoIP");
            if(ipSalvo) {
                document.getElementById("inputIP").value = ipSalvo;
            }
        }

        function salvarIpEConectar() {
            const ipDigitado = document.getElementById("inputIP").value.trim();

            if (ipDigitado === "") {
                alert("Por favor, digite um IP válido.");
                return;
            }

            // Monta a URL base: http://192.168.X.X:8080
            urlBase = `http://${ipDigitado}:${PORTA}`;

            // Salva no navegador para não ter que digitar de novo se atualizar a página
            localStorage.setItem("ultimoIP", ipDigitado);

            // Troca as telas
            document.getElementById("tela-config").style.display = "none";
            document.getElementById("tela-controle").style.display = "flex";
        }

        function trocarIP() {
            // Volta para a tela inicial
            document.getElementById("tela-controle").style.display = "none";
            document.getElementById("tela-config").style.display = "flex";
        }

        function enviarComando(acao) {
            if (!urlBase) return;

            // Envia para o endereço configurado
            fetch(`${urlBase}/${acao}`, { mode: 'no-cors' })
                .then(() => console.log("Enviado: " + acao))
                .catch(err => console.log("Erro: " + err));
        }
    </script>
</body>
</html>
